(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[791],{2376:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});var r=n(3464);let a=()=>localStorage.getItem("token"),l=r.A.create({baseURL:"https://adminapi.kvkd.tj/",headers:"application/json"});l.interceptors.request.use(e=>{let t=a();return t&&(e.headers.Authorization="Bearer ".concat(t)),e},e=>Promise.reject(e)),l.interceptors.response.use(e=>e,e=>{var t;return(null==(t=e.response)?void 0:t.status)===401&&(document.location.href="/login",console.warn("Unauthorized, redirecting to login...")),Promise.reject(e)});let i=l},4014:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});var r=n(5155),a=n(2115);let l=e=>{let{initialContent:t="",onContentChange:n,className:l=""}=e,i=(0,a.useRef)(null),[o,s]=(0,a.useState)(!1);(0,a.useEffect)(()=>{i.current&&t&&(i.current.innerHTML=t)},[]),(0,a.useEffect)(()=>{i.current&&0===t.length&&(i.current.innerHTML="")},[t]);let c=e=>{let t=window.getSelection();if(!(null==t?void 0:t.rangeCount)||!i.current)return;let n=t.getRangeAt(0);if(!t.toString())return;let r=document.createElement("div");r.appendChild(n.cloneContents());let a=!1,l=t=>{if(t.nodeType===Node.ELEMENT_NODE){if("bold"===e&&("bold"===t.style.fontWeight||"B"===t.tagName||"STRONG"===t.tagName)||"italic"===e&&("italic"===t.style.fontStyle||"I"===t.tagName||"EM"===t.tagName)||"underline"===e&&("underline"===t.style.textDecoration||"U"===t.tagName))return!0;for(let e=0;e<t.childNodes.length;e++)if(l(t.childNodes[e]))return!0}return!1};a=l(r);let o=d();a?document.execCommand("removeFormat",!1,e):document.execCommand(e,!1),h(),null!==o&&u(o)},d=()=>{let e=window.getSelection();if(!(null==e?void 0:e.rangeCount)||!i.current)return null;let t=e.getRangeAt(0),n=t.cloneRange();return n.selectNodeContents(i.current),n.setEnd(t.endContainer,t.endOffset),n.toString().length},u=e=>{if(!i.current)return;let t=window.getSelection(),n=document.createRange(),r=0,a=!1,l=t=>{if(t.nodeType===Node.TEXT_NODE){var i;let l=r+((null==(i=t.nodeValue)?void 0:i.length)||0);if(!a&&e>=r&&e<=l){let l=e-r;return n.setStart(t,l),n.setEnd(t,l),a=!0,!0}r=l}else for(let e=0;e<t.childNodes.length;e++)if(l(t.childNodes[e]))return!0;return!1};l(i.current),a&&(null==t||t.removeAllRanges(),null==t||t.addRange(n))},h=()=>{i.current&&n&&n(i.current.innerHTML)};return console.log("initialContent",t),(0,r.jsxs)("div",{className:"editor-container ".concat(l),children:[(0,r.jsxs)("div",{className:"toolbar",children:[(0,r.jsx)("button",{onClick:()=>c("bold"),title:"Жирный (Ctrl+B)",children:(0,r.jsx)("b",{children:"B"})}),(0,r.jsx)("button",{onClick:()=>c("italic"),title:"Курсив (Ctrl+I)",children:(0,r.jsx)("i",{children:"I"})}),(0,r.jsx)("button",{onClick:()=>c("underline"),title:"Подчеркивание (Ctrl+U)",children:(0,r.jsx)("u",{children:"U"})})]}),(0,r.jsx)("div",{ref:i,contentEditable:!0,className:"editable-area ".concat(o?"focused":""),onInput:h,onBlur:()=>s(!1),onFocus:()=>s(!0),onPaste:e=>{e.preventDefault();let t=e.clipboardData.getData("text/plain");document.execCommand("insertText",!1,t)},suppressContentEditableWarning:!0})]})};function i(e){let{title:t,error:n,id:a,value:i,required:o,classNameLabel:s,classNameTitle:c,classNameError:d,onChange:u}=e;return console.log("value",i),(0,r.jsxs)("label",{htmlFor:a,className:"input ".concat(s||""),children:[(0,r.jsxs)("h3",{className:" ".concat(c||""),children:[t," ",(0,r.jsx)("span",{children:o?"*":""})]}),(0,r.jsx)(l,{initialContent:i,onContentChange:e=>u(e)}),(0,r.jsx)("p",{style:{opacity:(null==n||n[a],1)},className:"".concat(d||"")})]})}},4871:(e,t,n)=>{"use strict";n.d(t,{A:()=>a});var r=n(5155);function a(e){let{title:t,error:n,id:a,type:l="text",value:i,required:o,placeholder:s,classNameLabel:c,classNameTitle:d,classNameInput:u,classNameError:h,onChange:m}=e;return(0,r.jsxs)("label",{htmlFor:a,className:"input ".concat(c||""),children:[(0,r.jsxs)("h3",{className:" ".concat(d||""),children:[t," ",(0,r.jsx)("span",{children:o?"*":""})]}),(0,r.jsx)("input",{className:"".concat(u||""),type:l,placeholder:s,id:a,onChange:e=>m(e.target.value),value:i}),(0,r.jsx)("p",{style:{opacity:(null==n||n[a],1)},className:"".concat(h||"")})]})}n(2115)},6299:(e,t,n)=>{Promise.resolve().then(n.bind(n,8501))},7861:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});var r=n(5155),a=n(8262),l=n(2376);function i(e){let{id:t,title:n,value:i,error:o,width:s,height:c,className:d,index:u,childrenKey:h,keyData:m}=e,{setData:p,data:g}=(0,a.x)(),f=async(e,t)=>{var n;let r=null==(n=e.target.files)?void 0:n[0];if(!r)return void console.error("No file selected");e.target.value="";let a=new FormData;a.append("file",r);try{let e=await l.A.post("/files/upload",a,{headers:{"Content-Type":"multipart/form-data"}});p(t,e.data.id)}catch(e){console.error("Upload error:",e)}},v=async(e,t,n,r)=>{var a;let i=null==(a=e.target.files)?void 0:a[0];if(!i)return void console.error("No file selected");let o=new FormData;o.append("file",i);let s=await l.A.post("/files/upload",o,{headers:{"Content-Type":"multipart/form-data"}});if(r){let e=Array.isArray(g.content)?[...g.content]:[];e[n]&&(e[n][r]=s.data.id),p(t,e)}else p(t,s.data.id)};return(0,r.jsxs)("div",{className:"file-photo ".concat(d),style:{width:s||"auto"},children:[(0,r.jsx)("label",{htmlFor:t,onClick:()=>{if(i)if(0===u||u){let e=Array.isArray(g.content)?[...g.content]:[];e[u]&&(e[u][h]=""),p(m||t,e)}else p(m||t,"")},children:i?"Нест кардан":n}),(0,r.jsx)("input",{type:"file",id:t,onChange:e=>{console.log("index",u),0===u||u?v(e,m||t,u,h):f(e,m||t)}}),i&&(0,r.jsx)("img",{src:"string"==typeof i?"https://adminapi.kvkd.tj/files/"+i:i,alt:t,width:s||300,height:c||300}),(0,r.jsx)("p",{className:"error",style:{opacity:+(null!=o&&!!o[t])},children:null==o?void 0:o[m||t]})]})}n(2115)},8262:(e,t,n)=>{"use strict";n.d(t,{t:()=>i,x:()=>l});var r=n(2376),a=n(5453);let l=(0,a.v)((e,t)=>({data:{},errors:{},setData:(t,n)=>e(e=>({data:{...e.data,[t]:n}})),setClear:()=>e(()=>({data:{}})),setDataMony:t=>e(()=>({data:t})),resetErrors:()=>e({errors:{}}),validate:n=>{let{data:r}=t(),a={};return Object.keys(n).forEach(e=>{let t=n[e],l=r[e];if(t.required&&(""===l||null==l)){a[e]=t.message||" Ин ҷои ҳатмист";return}if("string"==typeof l){if(t.minLength&&l.length<t.minLength){a[e]=t.message||"Камтар аз ".concat(t.minLength," аломат набояд бошад");return}if(t.maxLength&&l.length>t.maxLength){a[e]=t.message||"Аз ".concat(t.maxLength," аломат зиёд набояд бошад");return}if(t.pattern&&!t.pattern.test(l)){a[e]=t.message||"Формати нодуруст";return}}if("number"==typeof l){if(void 0!==t.min&&l<t.min){a[e]=t.message||"Аниқати камтарин: ".concat(t.min);return}if(void 0!==t.max&&l>t.max){a[e]=t.message||"Аниқати бештарин: ".concat(t.max);return}}}),e({errors:a}),0===Object.keys(a).length}})),i=(0,a.v)(()=>({getItems:async(e,t)=>{try{return(await r.A.get("".concat(e).concat(t?"/".concat(t):""))).data}catch(e){return console.error(e),null}}}))},8501:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>d});var r=n(5155),a=n(7861),l=n(4871),i=n(4014),o=n(8262),s=n(2376),c=n(2115);function d(){var e;let{data:t,errors:n,setData:d,validate:u}=(0,o.x)(),h=async()=>{if(u({main_title:{required:!0},main_photo_id:{required:!0}}))try{await s.A.post("pedagogical-council/add",t).then(()=>{d("main_title",""),d("main_photo_id",""),d("content",[{description:"",photo_id:""}])})}catch(e){console.error("Error sending data:",e)}else console.log("Form validation failed:",n)};return(0,c.useEffect)(()=>{d("content",[{description:"",photo_id:""}])},[]),console.log("data",t),(0,r.jsx)("div",{className:"adding",children:(0,r.jsxs)("div",{className:"adding-content",children:[(0,r.jsxs)("div",{className:"main-form",children:[(0,r.jsxs)("div",{className:"adding-header",children:[(0,r.jsx)("h1",{children:"Илова"}),(0,r.jsx)("button",{onClick:h,children:"Фиристодан"})]}),(0,r.jsxs)("div",{className:"adding-form",children:[(0,r.jsx)(l.A,{required:!0,title:" Сарлавҳа",type:"text",placeholder:" Сарлавҳа",id:"main_title",value:(null==t?void 0:t.main_title)||"",onChange:e=>d("main_title",e),error:n}),(0,r.jsx)(a.A,{keyData:"main_photo_id",id:"main_photo_id_label",title:"Аксро бор кардан",value:null==t?void 0:t.main_photo_id,error:n})]})]}),(0,r.jsxs)("div",{className:"adding-form-content",children:[Array.isArray(null==t?void 0:t.content)&&(null==t||null==(e=t.content)?void 0:e.map((e,l,o)=>(0,r.jsxs)("div",{className:"adding-form-item",children:[(0,r.jsx)(i.A,{title:"Тавсиф",id:"description",placeholder:"Тавсиф",value:e.description,error:n,required:!0,onChange:e=>{let n=Array.isArray(t.content)?[...t.content]:[];n[l]&&(n[l].description=e,d("content",n))}}),(0,r.jsxs)("div",{children:[(0,r.jsx)(a.A,{keyData:"content",id:"content-".concat(l),index:l,childrenKey:"photo_id",title:"Аксро бор кардан",value:null==e?void 0:e.photo_id,error:n}),0!==l&&(0,r.jsx)("button",{onClick:()=>{d("content",o.filter((e,t)=>t!==l))},children:"-"})]})]},l))),(0,r.jsx)("button",{onClick:()=>{let e=Array.isArray(t.content)?[...t.content]:[];e.push({description:"",photo_id:""}),d("content",e)},children:"Илова кардани унсур"})]})]})})}}},e=>{var t=t=>e(e.s=t);e.O(0,[604,441,684,358],()=>t(6299)),_N_E=e.O()}]);